@reference "tailwindcss"

@layer components {
  /* Base brand button: default rounded edges and interactions */
  .btn-brand {
    @apply rounded-full px-6 py-3 inline-flex items-center justify-center gap-2 font-medium transition-all shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95 focus:outline-none focus:ring-2 focus:ring-[var(--brand-accent)] focus:ring-offset-2 focus:ring-offset-[var(--brand-bg)] overflow-hidden;
    font-family: var(--font-button), sans-serif;
  }

  .btn-primary {
    /* Use brand tokens */
    @apply btn-brand;
    background-color: var(--brand-primary);
    color: var(--brand-primary-contrast);
    border: 1px solid var(--brand-primary);
  }
  .btn-primary:hover {
    background-color: color-mix(in oklab, var(--brand-primary) 85%, white 15%);
  }
  .btn-primary:active {
    transform: translateY(1px);
  }

  .btn-ghost {
    @apply btn-brand border border-transparent;
    color: var(--brand-primary);
    background-color: transparent;
  }
  .btn-ghost:hover {
    background-color: color-mix(in oklab, var(--brand-primary) 10%, var(--brand-surface) 90%);
    color: var(--brand-primary);
  }

  /* Brand outlined button: transparent fill with visible border */
  .btn-outline {
    @apply btn-brand;
    background-color: transparent;
    color: var(--brand-primary);
    border: 1px solid var(--brand-primary);
  }
  .btn-outline:hover {
    background-color: color-mix(in oklab, var(--brand-primary) 10%, var(--brand-surface) 90%);
  }
  .btn-outline:active {
    transform: translateY(1px);
  }

  /* Contact form CTA: stronger border + soft, faded fill */
  .btn-outline-cta {
    @apply btn-brand font-semibold; /* inherits rounded-full, padding, layout, transitions */
    border-radius: 9999px; /* ensure pill corners regardless of any resets */
    color: var(--brand-primary);
    /* More prominent border using accent+primary mix */
    border: 2px solid color-mix(in oklab, var(--brand-accent) 65%, var(--brand-primary) 35%);
    /* Faded light background to lift from purple page bg */
    background-color: color-mix(in oklab, var(--brand-primary) 14%, white 86%);
  }
  .btn-outline-cta:hover {
    background-color: color-mix(in oklab, var(--brand-primary) 20%, white 80%);
    box-shadow: 0 8px 18px -8px color-mix(in oklab, var(--brand-accent) 35%, transparent);
  }
  .btn-outline-cta:active {
    transform: translateY(1px);
  }

  .card {
    @apply relative overflow-hidden rounded-lg shadow-md;
    background-color: var(--brand-surface);
    color: var(--brand-fg);
  }

  .card .hero-overlay {
    @apply pointer-events-none absolute inset-0;
    background-color: var(--brand-overlay-muted);
  }

}

@layer utilities {
  .max-w-site {
    max-width: var(--layout-max-width);
    width: 100%;
    margin-left: auto;
    margin-right: auto;
  }

  /* Toned-down border pulse for CTAs */
  @keyframes border-pulse-soft {
    0%, 100% {
      box-shadow:
        0 1px 6px 0 color-mix(in oklab, var(--brand-border) 40%, transparent),
        0 0 0 0 color-mix(in oklab, var(--brand-accent) 0%, transparent);
    }
    50% {
      box-shadow:
        0 2px 12px 2px color-mix(in oklab, var(--brand-border) 55%, transparent),
        0 0 10px 2px color-mix(in oklab, var(--brand-accent) 35%, transparent);
    }
  }
  .pulse-border-soft {
    animation: border-pulse-soft 5000ms ease-in-out infinite;
    will-change: box-shadow;
  }

  /* Logo loading pulse */
  @keyframes logo-pulse {
    0%, 100% {
      opacity: 0.75;
      transform: scale(1);
    }
    25% {
      opacity: 0.6;
      transform: scale(1.1);
    }
    50% {
      opacity: 0.5;
      transform: scale(1);
    }
    75% {
      opacity: 0.6;
      transform: scale(0.9);
    }
  }
  .animate-logo-pulse {
    animation: logo-pulse 800ms ease-in-out infinite;
    will-change: opacity, transform;
  }

  /* Fade-in animations */
  @keyframes fade-in-up {
    0% {
      opacity: 0;
      transform: translateY(8px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }
  @keyframes fade-in-down {
    0% {
      opacity: 0;
      transform: translateY(-8px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-fade-in-up {
    animation: fade-in-up 500ms cubic-bezier(0.22, 1, 0.36, 1) both;
  }
  .animate-fade-in-down {
    animation: fade-in-down 500ms cubic-bezier(0.22, 1, 0.36, 1) both;
  }
  @keyframes fade-in-opacity {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  .animate-fade-in-opacity {
    animation: fade-in-opacity 300ms ease-out both;
  }

  /* Strong entrance from the very top of the page */
  @keyframes slide-in-from-top {
    0% {
      opacity: 0;
      /* Start above the header and slide down into place (distance equals header height) */
      transform: translateY(calc(-1 * var(--header-height-px, 64px)));
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-slide-in-from-top {
    animation: slide-in-from-top 600ms cubic-bezier(0.22, 1, 0.36, 1) both;
    will-change: transform, opacity;
    backface-visibility: hidden;
  }

  /* Spiral drop animation for MapBlock container */
  @keyframes spiralDrop {
    0% {
      transform: translate(-150%, -150%) rotate(-720deg) scale(0.2);
      opacity: 0;
    }
    50% {
      transform: translate(20%, 20%) rotate(-360deg) scale(0.6);
      opacity: 1;
    }
    75% {
      transform: translate(-10%, 5%) rotate(-180deg) scale(0.85);
    }
    100% {
      transform: translate(0, 0) rotate(0) scale(1);
      opacity: 1;
    }
  }
  .animate-spiral-drop {
    animation: spiralDrop 800ms cubic-bezier(0.34, 1.56, 0.64, 1) both;
    will-change: transform, opacity;
    backface-visibility: hidden;
  }

  /* Marquee animations */
  @keyframes marquee {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-50%);
    }
  }

  .animate-marquee {
    animation: marquee 20s linear infinite;
    will-change: transform;
  }

  .animate-marquee-single {
    animation: marquee-single var(--marquee-duration) linear infinite;
    animation-delay: var(--marquee-delay);
    will-change: transform;
  }

  .animate-marquee-intro {
    animation: marquee-intro var(--marquee-duration) linear both;
    will-change: transform;
  }

  .marquee-viewport {
    position: relative;
    width: 100%;
  }
  .marquee-track {
    display: inline-flex;
    white-space: nowrap;
    gap: var(--marquee-gap);
  }

  @keyframes marquee-single {
    from {
      transform: translate3d(0, 0, 0);
    }
    to {
      transform: translate3d(calc(-1 * (var(--content-width) + var(--marquee-gap))), 0, 0);
    }
  }

  @keyframes marquee-intro {
    from {
      transform: translate3d(calc(var(--container-width) - 1%), 0, 0);
    }
    to {
      transform: translate3d(calc(-1 * var(--content-width)), 0, 0);
    }
  }

  /* Announcement banner border glow */
  @keyframes annc-border-glow {
    0%, 100% {
      box-shadow:
        0 1px 8px 0 color-mix(in oklab, var(--brand-border) 60%, transparent),
        0 0 0 0 color-mix(in oklab, var(--brand-accent) 0%, transparent);
    }
    50% {
      box-shadow:
        0 2px 14px 2px color-mix(in oklab, var(--brand-border) 70%, transparent),
        0 0 18px 4px color-mix(in oklab, var(--brand-accent) 60%, transparent);
    }
  }
  .annc-border-glow {
    position: relative;
  }
  .annc-border-glow::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    pointer-events: none;
    animation: annc-border-glow 2400ms ease-in-out infinite;
    will-change: box-shadow;
  }

  /* Generic element border glow (applies animation to the element itself) */
  .border-glow {
    animation: annc-border-glow 2400ms ease-in-out infinite;
    will-change: box-shadow;
  }

  /* Shake nudge animation */
  @keyframes nudge-shake {
    0% { transform: translateX(0) rotate(0); }
    15% { transform: translateX(-2px) rotate(-1deg); }
    30% { transform: translateX(2px) rotate(1deg); }
    45% { transform: translateX(-2px) rotate(-1deg); }
    60% { transform: translateX(2px) rotate(1deg); }
    75% { transform: translateX(-1px) rotate(0.5deg); }
    100% { transform: translateX(0) rotate(0); }
  }
  .animate-shake {
    animation: nudge-shake 800ms ease-in-out 3;
    transform-origin: center;
    will-change: transform;
  }

  /* Shimmer text animation for announcement banner */
  @keyframes shimmer-sweep {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
  }
  .shimmer-text {
    /* Base gradient is the brand accent with a moving lighter band */
    background-image: linear-gradient(
      100deg,
      color-mix(in oklab, var(--brand-accent) 95%, white 5%) 0%,
      color-mix(in oklab, var(--brand-accent) 95%, white 5%) 40%,
      color-mix(in oklab, var(--brand-accent) 60%, white 40%) 50%,
      color-mix(in oklab, var(--brand-accent) 95%, white 5%) 60%,
      color-mix(in oklab, var(--brand-accent) 95%, white 5%) 100%
    );
    background-size: 200% 100%;
    -webkit-background-clip: text;
    background-clip: text;
    /* Make the gradient define the text color */
    color: transparent;
    -webkit-text-fill-color: transparent;
    animation: shimmer-sweep 2.2s linear infinite;
  }
  /* Slower variant for long, subtle shimmer (e.g., site title) */
  .shimmer-text-slow {
    background-image: linear-gradient(
      100deg,
      color-mix(in oklab, var(--brand-accent) 95%, white 5%) 0%,
      color-mix(in oklab, var(--brand-accent) 95%, white 5%) 40%,
      color-mix(in oklab, var(--brand-accent) 60%, white 40%) 50%,
      color-mix(in oklab, var(--brand-accent) 95%, white 5%) 60%,
      color-mix(in oklab, var(--brand-accent) 95%, white 5%) 100%
    );
    background-size: 200% 100%;
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    -webkit-text-fill-color: transparent;
    animation: shimmer-sweep 12s linear infinite;
  }

  /* Cancel shimmer on hover for opted elements */
  .no-shimmer-on-hover:hover,
  .no-shimmer-on-hover:focus,
  .no-shimmer-on-hover:active {
    background-image: none !important;
    -webkit-background-clip: border-box !important;
    background-clip: border-box !important;
    color: var(--brand-alt) !important;
    -webkit-text-fill-color: var(--brand-alt) !important;
  }

  /* Soft pulsing glow for prominent titles */
  @keyframes text-glow-pulse {
    0%, 100% {
      text-shadow:
        0 0 0 transparent,
        0 0 0 transparent;
    }
    50% {
      text-shadow:
        0 0 6px color-mix(in oklab, var(--brand-accent) 70%, transparent),
        0 0 14px color-mix(in oklab, var(--brand-accent) 55%, transparent);
    }
  }
  .glow-text {
    animation: text-glow-pulse 2400ms ease-in-out infinite;
    will-change: text-shadow, filter;
  }
  /* Hover-only variant for glow */
  .glow-text-hover:hover,
  .glow-text-hover:focus,
  .glow-text-hover:active {
    animation: text-glow-pulse 4200ms ease-in-out infinite;
    will-change: text-shadow, filter;
  }

  @media (prefers-reduced-motion: reduce) {
    .animate-marquee,
    .animate-marquee-single,
    .animate-marquee-intro {
      animation-duration: 0.01ms;
      animation-iteration-count: 1;
    }
    .animate-fade-in-up,
    .animate-fade-in-down,
    .animate-fade-in-opacity,
    .animate-slide-in-from-top,
    .animate-shake,
    .annc-border-glow,
    .annc-border-glow::after,
    .border-glow,
    .pulse-border-soft,
    .shimmer-text,
    .shimmer-text-slow,
    .glow-text,
    .glow-text-hover {
      animation: none;
      opacity: 1 !important;
      transform: none !important;
      /* In reduced motion, fall back to static text color */
      background-image: none !important;
      color: var(--brand-accent) !important;
      -webkit-text-fill-color: var(--brand-accent) !important;
    }
  }
}


